This is a tiny implementation of consistency model in Pytorch using diffusion transformer. See `https://zhuanlan.zhihu.com/p/1979687312045654245/` for more information
We adopt the main architecture of diffusion transformer (`https://github.com/facebookresearch/DiT/blob/main/models.py`) without any modification, except that we remove the `learn_sigma` configuration from the model and replace it with `learn_v`. `learn_sigma` is used in old diffusion models to learn to predict the noise variance, but it's not quite used these days. Our model supports `learn_v`. When `learn_v` is False, the model will only output `w`. When `learn_v` is True, the model will output both `w` and `v`. `v` is just the normal ODE target (e.g. x1 - x0 in flow matching) and `w` is the vector field such that `f(t)w(x_t, t) = intergral of v from 0 to t`
Follow `https://github.com/facebookresearch/DiT`'s instruction to install necessary dependencies.
Run `python main.py` to run the code. By default, we do not use learned v.